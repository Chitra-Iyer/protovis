<html>
  <head>
    <title>Crimean War</title>
    <link type="text/css" rel="stylesheet" href="ex.css?3.1"/>
    <script type="text/javascript" src="../protovis-r3.2.js"></script>
    <script type="text/javascript" src="crimea.js"></script>
    <style type="text/css">
      #fig {
        width: 600px;
        height: 300px;
      }
    </style>
  </head>
  <body><div id="center"><div id="fig">
    <script type="text/javascript+protovis">

      var w = 545,
          h = 280,
          x = pv.Scale.linear(0, crimea.length - 1).range(0, w),
          y = pv.Scale.linear(0, 2200).range(0, h),
          c = pv.colors("lightblue", "lightpink", "darkgray").domain(causes),
          fi = pv.Format.date("%m/%y"),
          fo = pv.Format.date("%b");

      var vis = new pv.Panel()
          .width(w)
          .height(h)
          .right(40)
          .bottom(14)
          .top(.5);

      vis.add(pv.Panel)
          .data(["wounds", "other", "disease"])
        .add(pv.Area)
          .data(crimea)
          .bottom(pv.Layout.stack())
          .height(function(d, t) y(d[t]))
          .left(function() x(this.index))
          .fillStyle(function(d, t) c(t))
          .strokeStyle(function() this.fillStyle().darker())
          .lineWidth(1)
        .anchor("bottom").add(pv.Label)
          .visible(function() !this.parent.index && !(this.index % 3))
          .textStyle("#666")
          .textBaseline("top")
          .textAlign("left")
          .text(function(d) fo(fi.parse(d.date)));

      vis.add(pv.Rule)
          .data(y.ticks())
          .strokeStyle(function(i) i ? "white" : "black")
          .bottom(y)
        .anchor("right").add(pv.Label)
          .textStyle("#666");

      vis.render();

    </script>
  </div></div></body>
</html>
