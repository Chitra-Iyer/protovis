<html>
  <head>
    <title>Spline Editor</title>
    <link type="text/css" rel="stylesheet" href="ex.css?3.2"/>
    <script type="text/javascript" src="../protovis-r3.2.js"></script>
    <style type="text/css">
      #fig {
        width: 800px;
        height: 600px;
      }
    </style>
  </head>
  <body><div id="center"><div id="fig">
    Interpolate:
    <select onchange="interpolate = this.value; vis.render();">
      <option value="cardinal" selected>Cardinal</option>
      <option value="monotone">Monotone</option>
      <option value="basis">Basis</option>
      <option value="linear">Linear</option>
      <option value="step-before">Step (before)</option>
      <option value="step-after">Step (after)</option>
    </select>
    &nbsp;
    <input type="checkbox" onchange="segmented = this.checked; vis.render()">Segmented
    &nbsp;
    &nbsp;
    (click anywhere to add a point, pres delete to remove the active point)
    <script type="text/javascript+protovis">

var w = 766,
    h = 596,
    i = 3,
    interpolate = "cardinal",
    segmented = false;

var points = pv.range(1, 5).map(function(i) ({
        x: i * w / 5,
        y: 50 + Math.random() * (h - 100)
      }));

var vis = new pv.Panel()
    .width(w)
    .height(h)
    .strokeStyle("#ccc")
    .fillStyle("#fff")
    .margin(2)
    .event("mousedown", function() (i = points.push(this.mouse()) - 1, this));

vis.add(pv.Line)
    .data(function() points)
    .left(function(d) d.x)
    .top(function(d) d.y)
    .interpolate(function() interpolate)
    .segmented(function() segmented)
    .strokeStyle(pv.Colors.category10().by(pv.index))
    .tension(0.5)
    .lineWidth(2);

vis.add(pv.Dot)
    .data(function() points)
    .left(function(d) d.x)
    .top(function(d) d.y)
    .radius(7)
    .cursor("move")
    .strokeStyle(function() i == this.index ? "#ff7f0e" : "#1f77b4")
    .fillStyle(function() this.strokeStyle().alpha(.2))
    .event("mousedown", pv.Behavior.drag())
    .event("dragstart", function() (i = this.index, this))
    .event("drag", vis);

vis.render();

pv.listen(window, "keydown", function(e) {
  // code 8 is backspace, code 46 is delete
  if ((e.keyCode == 8 || e.keyCode == 46) && (i >= 0)) {
    points.splice(i--, 1);
    vis.render();
    e.preventDefault();
  }
});

self.focus();
    </script>
  </div></div></body>
</html>
